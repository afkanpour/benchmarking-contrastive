Mon May 13 07:30:12 2024       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 525.105.17   Driver Version: 525.105.17   CUDA Version: 12.0     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  NVIDIA A100-SXM...  On   | 00000000:17:00.0 Off |                    0 |
| N/A   37C    P0    63W / 500W |      0MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   1  NVIDIA A100-SXM...  On   | 00000000:31:00.0 Off |                    0 |
| N/A   36C    P0    62W / 500W |      0MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   2  NVIDIA A100-SXM...  On   | 00000000:B1:00.0 Off |                    0 |
| N/A   35C    P0    63W / 500W |      0MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   3  NVIDIA A100-SXM...  On   | 00000000:CA:00.0 Off |                    0 |
| N/A   36C    P0    61W / 500W |      0MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
SLURM_ARRAY_JOB_ID=
SLURM_JOBID=12581130
2024-05-13,07:30:22 | INFO | No latest resume checkpoint found in /checkpoint/yaspar/12581130/HPtuning_warmup_5000/checkpoints.
NCCL version 2.14.3+cuda11.7
2024-05-13,07:30:28 | INFO | Running in distributed mode with multiple processes. Device: cuda:0.Process (global: 0, local 0), total 4.
2024-05-13,07:30:28 | INFO | Loading pretrained ViT-B-32 from OpenAI.
2024-05-13,07:30:28 | INFO | Running in distributed mode with multiple processes. Device: cuda:1.Process (global: 1, local 1), total 4.
2024-05-13,07:30:28 | INFO | Running in distributed mode with multiple processes. Device: cuda:3.Process (global: 3, local 3), total 4.
2024-05-13,07:30:28 | INFO | Loading pretrained ViT-B-32 from OpenAI.
2024-05-13,07:30:28 | INFO | Running in distributed mode with multiple processes. Device: cuda:2.Process (global: 2, local 2), total 4.
2024-05-13,07:30:28 | INFO | Loading pretrained ViT-B-32 from OpenAI.
2024-05-13,07:30:28 | INFO | Loading pretrained ViT-B-32 from OpenAI.
/fs01/home/yaspar/Documents/GitHub/Multimodal/MedMultiModal/src/open_clip/transform.py:378: UserWarning: Unused augmentation cfg items, specify `use_timm` to use (['scale', 'quilt_crop', 'num_views']).
  warnings.warn(f'Unused augmentation cfg items, specify `use_timm` to use ({list(aug_cfg_dict.keys())}).')
/fs01/home/yaspar/Documents/GitHub/Multimodal/MedMultiModal/src/open_clip/transform.py:378: UserWarning: Unused augmentation cfg items, specify `use_timm` to use (['scale', 'quilt_crop', 'num_views']).
  warnings.warn(f'Unused augmentation cfg items, specify `use_timm` to use ({list(aug_cfg_dict.keys())}).')
/fs01/home/yaspar/Documents/GitHub/Multimodal/MedMultiModal/src/open_clip/transform.py:378: UserWarning: Unused augmentation cfg items, specify `use_timm` to use (['scale', 'quilt_crop', 'num_views']).
  warnings.warn(f'Unused augmentation cfg items, specify `use_timm` to use ({list(aug_cfg_dict.keys())}).')
/fs01/home/yaspar/Documents/GitHub/Multimodal/MedMultiModal/src/open_clip/transform.py:378: UserWarning: Unused augmentation cfg items, specify `use_timm` to use (['scale', 'quilt_crop', 'num_views']).
  warnings.warn(f'Unused augmentation cfg items, specify `use_timm` to use ({list(aug_cfg_dict.keys())}).')
2024-05-13,07:30:34 | INFO | Model:
2024-05-13,07:30:34 | INFO | CLIP(
  (visual): VisionTransformer(
    (conv1): Conv2d(3, 768, kernel_size=(32, 32), stride=(32, 32), bias=False)
    (patch_dropout): Identity()
    (ln_pre): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (transformer): Transformer(
      (resblocks): ModuleList(
        (0): ResidualAttentionBlock(
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
          )
          (ls_1): Identity()
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ls_2): Identity()
        )
        (1): ResidualAttentionBlock(
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
          )
          (ls_1): Identity()
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ls_2): Identity()
        )
        (2): ResidualAttentionBlock(
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
          )
          (ls_1): Identity()
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ls_2): Identity()
        )
        (3): ResidualAttentionBlock(
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
          )
          (ls_1): Identity()
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ls_2): Identity()
        )
        (4): ResidualAttentionBlock(
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
          )
          (ls_1): Identity()
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ls_2): Identity()
        )
        (5): ResidualAttentionBlock(
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
          )
          (ls_1): Identity()
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ls_2): Identity()
        )
        (6): ResidualAttentionBlock(
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
          )
          (ls_1): Identity()
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ls_2): Identity()
        )
        (7): ResidualAttentionBlock(
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
          )
          (ls_1): Identity()
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ls_2): Identity()
        )
        (8): ResidualAttentionBlock(
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
          )
          (ls_1): Identity()
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ls_2): Identity()
        )
        (9): ResidualAttentionBlock(
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
          )
          (ls_1): Identity()
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ls_2): Identity()
        )
        (10): ResidualAttentionBlock(
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
          )
          (ls_1): Identity()
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ls_2): Identity()
        )
        (11): ResidualAttentionBlock(
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
          )
          (ls_1): Identity()
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): QuickGELU()
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ls_2): Identity()
        )
      )
    )
    (ln_post): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
  )
  (transformer): Transformer(
    (resblocks): ModuleList(
      (0): ResidualAttentionBlock(
        (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
        )
        (ls_1): Identity()
        (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (mlp): Sequential(
          (c_fc): Linear(in_features=512, out_features=2048, bias=True)
          (gelu): QuickGELU()
          (c_proj): Linear(in_features=2048, out_features=512, bias=True)
        )
        (ls_2): Identity()
      )
      (1): ResidualAttentionBlock(
        (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
        )
        (ls_1): Identity()
        (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (mlp): Sequential(
          (c_fc): Linear(in_features=512, out_features=2048, bias=True)
          (gelu): QuickGELU()
          (c_proj): Linear(in_features=2048, out_features=512, bias=True)
        )
        (ls_2): Identity()
      )
      (2): ResidualAttentionBlock(
        (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
        )
        (ls_1): Identity()
        (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (mlp): Sequential(
          (c_fc): Linear(in_features=512, out_features=2048, bias=True)
          (gelu): QuickGELU()
          (c_proj): Linear(in_features=2048, out_features=512, bias=True)
        )
        (ls_2): Identity()
      )
      (3): ResidualAttentionBlock(
        (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
        )
        (ls_1): Identity()
        (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (mlp): Sequential(
          (c_fc): Linear(in_features=512, out_features=2048, bias=True)
          (gelu): QuickGELU()
          (c_proj): Linear(in_features=2048, out_features=512, bias=True)
        )
        (ls_2): Identity()
      )
      (4): ResidualAttentionBlock(
        (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
        )
        (ls_1): Identity()
        (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (mlp): Sequential(
          (c_fc): Linear(in_features=512, out_features=2048, bias=True)
          (gelu): QuickGELU()
          (c_proj): Linear(in_features=2048, out_features=512, bias=True)
        )
        (ls_2): Identity()
      )
      (5): ResidualAttentionBlock(
        (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
        )
        (ls_1): Identity()
        (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (mlp): Sequential(
          (c_fc): Linear(in_features=512, out_features=2048, bias=True)
          (gelu): QuickGELU()
          (c_proj): Linear(in_features=2048, out_features=512, bias=True)
        )
        (ls_2): Identity()
      )
      (6): ResidualAttentionBlock(
        (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
        )
        (ls_1): Identity()
        (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (mlp): Sequential(
          (c_fc): Linear(in_features=512, out_features=2048, bias=True)
          (gelu): QuickGELU()
          (c_proj): Linear(in_features=2048, out_features=512, bias=True)
        )
        (ls_2): Identity()
      )
      (7): ResidualAttentionBlock(
        (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
        )
        (ls_1): Identity()
        (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (mlp): Sequential(
          (c_fc): Linear(in_features=512, out_features=2048, bias=True)
          (gelu): QuickGELU()
          (c_proj): Linear(in_features=2048, out_features=512, bias=True)
        )
        (ls_2): Identity()
      )
      (8): ResidualAttentionBlock(
        (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
        )
        (ls_1): Identity()
        (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (mlp): Sequential(
          (c_fc): Linear(in_features=512, out_features=2048, bias=True)
          (gelu): QuickGELU()
          (c_proj): Linear(in_features=2048, out_features=512, bias=True)
        )
        (ls_2): Identity()
      )
      (9): ResidualAttentionBlock(
        (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
        )
        (ls_1): Identity()
        (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (mlp): Sequential(
          (c_fc): Linear(in_features=512, out_features=2048, bias=True)
          (gelu): QuickGELU()
          (c_proj): Linear(in_features=2048, out_features=512, bias=True)
        )
        (ls_2): Identity()
      )
      (10): ResidualAttentionBlock(
        (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
        )
        (ls_1): Identity()
        (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (mlp): Sequential(
          (c_fc): Linear(in_features=512, out_features=2048, bias=True)
          (gelu): QuickGELU()
          (c_proj): Linear(in_features=2048, out_features=512, bias=True)
        )
        (ls_2): Identity()
      )
      (11): ResidualAttentionBlock(
        (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
        )
        (ls_1): Identity()
        (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (mlp): Sequential(
          (c_fc): Linear(in_features=512, out_features=2048, bias=True)
          (gelu): QuickGELU()
          (c_proj): Linear(in_features=2048, out_features=512, bias=True)
        )
        (ls_2): Identity()
      )
    )
  )
  (token_embedding): Embedding(49408, 512)
  (ln_final): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
)
2024-05-13,07:30:34 | INFO | Params:
2024-05-13,07:30:34 | INFO |   accum_freq: 4
2024-05-13,07:30:34 | INFO |   aug_cfg: {'quilt_crop': True}
2024-05-13,07:30:34 | INFO |   batch_size: 1024
2024-05-13,07:30:34 | INFO |   beta1: 0.9
2024-05-13,07:30:34 | INFO |   beta2: 0.98
2024-05-13,07:30:34 | INFO |   checkpoint_path: /checkpoint/yaspar/12581130/HPtuning_warmup_5000/checkpoints
2024-05-13,07:30:34 | INFO |   coca_caption_loss_weight: 2.0
2024-05-13,07:30:34 | INFO |   coca_contrastive_loss_weight: 1.0
2024-05-13,07:30:34 | INFO |   copy_codebase: False
2024-05-13,07:30:34 | INFO |   csv_caption_key: title
2024-05-13,07:30:34 | INFO |   csv_img_key: filepath
2024-05-13,07:30:34 | INFO |   csv_img_root: 
2024-05-13,07:30:34 | INFO |   csv_separator: ,
2024-05-13,07:30:34 | INFO |   dataset_resampled: False
2024-05-13,07:30:34 | INFO |   dataset_type: mixed
2024-05-13,07:30:34 | INFO |   ddp_static_graph: False
2024-05-13,07:30:34 | INFO |   debug: False
2024-05-13,07:30:34 | INFO |   delete_previous_checkpoint: False
2024-05-13,07:30:34 | INFO |   device: cuda:0
2024-05-13,07:30:34 | INFO |   dist_backend: nccl
2024-05-13,07:30:34 | INFO |   dist_url: env://
2024-05-13,07:30:34 | INFO |   distill: False
2024-05-13,07:30:34 | INFO |   distill_model: None
2024-05-13,07:30:34 | INFO |   distill_pretrained: None
2024-05-13,07:30:34 | INFO |   distributed: True
2024-05-13,07:30:34 | INFO |   epochs: 20
2024-05-13,07:30:34 | INFO |   epochs_cooldown: None
2024-05-13,07:30:34 | INFO |   eps: 1e-06
2024-05-13,07:30:34 | INFO |   force_custom_text: False
2024-05-13,07:30:34 | INFO |   force_image_size: None
2024-05-13,07:30:34 | INFO |   force_patch_dropout: None
2024-05-13,07:30:34 | INFO |   force_quick_gelu: False
2024-05-13,07:30:34 | INFO |   gather_with_grad: True
2024-05-13,07:30:34 | INFO |   grad_checkpointing: False
2024-05-13,07:30:34 | INFO |   grad_clip_norm: None
2024-05-13,07:30:34 | INFO |   horovod: False
2024-05-13,07:30:34 | INFO |   image_contrast: False
2024-05-13,07:30:34 | INFO |   image_interpolation: None
2024-05-13,07:30:34 | INFO |   image_mean: None
2024-05-13,07:30:34 | INFO |   image_resize_mode: None
2024-05-13,07:30:34 | INFO |   image_std: None
2024-05-13,07:30:34 | INFO |   imagenet_v2: None
2024-05-13,07:30:34 | INFO |   imagenet_val: None
2024-05-13,07:30:34 | INFO |   local_loss: False
2024-05-13,07:30:34 | INFO |   local_rank: 0
2024-05-13,07:30:34 | INFO |   lock_image: False
2024-05-13,07:30:34 | INFO |   lock_image_freeze_bn_stats: False
2024-05-13,07:30:34 | INFO |   lock_image_unlocked_groups: 0
2024-05-13,07:30:34 | INFO |   lock_text: False
2024-05-13,07:30:34 | INFO |   lock_text_decoder: False
2024-05-13,07:30:34 | INFO |   lock_text_freeze_layer_norm: False
2024-05-13,07:30:34 | INFO |   lock_text_unlocked_layers: 0
2024-05-13,07:30:34 | INFO |   log_every_n_steps: 100
2024-05-13,07:30:34 | INFO |   log_level: 20
2024-05-13,07:30:34 | INFO |   log_local: False
2024-05-13,07:30:34 | INFO |   log_path: /checkpoint/yaspar/12581130/HPtuning_warmup_5000/out.log
2024-05-13,07:30:34 | INFO |   logs: /checkpoint/yaspar/12581130/
2024-05-13,07:30:34 | INFO |   lr: 5e-05
2024-05-13,07:30:34 | INFO |   lr_cooldown_end: 0.0
2024-05-13,07:30:34 | INFO |   lr_cooldown_power: 1.0
2024-05-13,07:30:34 | INFO |   lr_scheduler: cosine
2024-05-13,07:30:34 | INFO |   mask_contrast: False
2024-05-13,07:30:34 | INFO |   model: ViT-B-32
2024-05-13,07:30:34 | INFO |   name: HPtuning_warmup_5000
2024-05-13,07:30:34 | INFO |   no_set_device_rank: False
2024-05-13,07:30:34 | INFO |   pathmnist: False
2024-05-13,07:30:34 | INFO |   precision: amp
2024-05-13,07:30:34 | INFO |   pretrained: openai
2024-05-13,07:30:34 | INFO |   pretrained_image: False
2024-05-13,07:30:34 | INFO |   quilt_roi_selection_prob: 0.0
2024-05-13,07:30:34 | INFO |   rank: 0
2024-05-13,07:30:34 | INFO |   remote_sync: None
2024-05-13,07:30:34 | INFO |   remote_sync_frequency: 300
2024-05-13,07:30:34 | INFO |   remote_sync_protocol: s3
2024-05-13,07:30:34 | INFO |   report_to: wandb
2024-05-13,07:30:34 | INFO |   resume: None
2024-05-13,07:30:34 | INFO |   save_frequency: 1
2024-05-13,07:30:34 | INFO |   save_most_recent: False
2024-05-13,07:30:34 | INFO |   seed: 0
2024-05-13,07:30:34 | INFO |   siglip: False
2024-05-13,07:30:34 | INFO |   skip_scheduler: False
2024-05-13,07:30:34 | INFO |   tensorboard: False
2024-05-13,07:30:34 | INFO |   tensorboard_path: 
2024-05-13,07:30:34 | INFO |   torchcompile: False
2024-05-13,07:30:34 | INFO |   torchscript: False
2024-05-13,07:30:34 | INFO |   trace: False
2024-05-13,07:30:34 | INFO |   train_data: /projects/multimodal/datasets/pmc_oa/train.jsonl::/projects/multimodal/datasets/Quilt_1M/quilt_1m_train.csv::/projects/multimodal/datasets/mimic_cxr/mimic_cxr_double_image_train.csv::/projects/aieng/multimodal/datasets/roco/cache/radiologytraindata.csv
2024-05-13,07:30:34 | INFO |   train_data_upsampling_factors: None
2024-05-13,07:30:34 | INFO |   train_num_samples: 2769337
2024-05-13,07:30:34 | INFO |   use_bn_sync: False
2024-05-13,07:30:34 | INFO |   use_bnb_linear: None
2024-05-13,07:30:34 | INFO |   val_data: /projects/multimodal/datasets/pmc_oa/valid.jsonl
2024-05-13,07:30:34 | INFO |   val_frequency: 1
2024-05-13,07:30:34 | INFO |   val_no_retrieval: True
2024-05-13,07:30:34 | INFO |   val_num_samples: None
2024-05-13,07:30:34 | INFO |   wandb: True
2024-05-13,07:30:34 | INFO |   wandb_notes: 
2024-05-13,07:30:34 | INFO |   wandb_offline: False
2024-05-13,07:30:34 | INFO |   wandb_project_name: open-multi-modal
2024-05-13,07:30:34 | INFO |   warmup: 5000
2024-05-13,07:30:34 | INFO |   wd: 0.1
2024-05-13,07:30:34 | INFO |   workers: 4
2024-05-13,07:30:34 | INFO |   world_size: 4
2024-05-13,07:30:34 | INFO |   zeroshot_frequency: 1
2024-05-13,07:31:10 | INFO | Loaded mixed dataset with 2755782 samples.
2024-05-13,07:31:11 | INFO | Loaded mixed dataset with 2755782 samples.
2024-05-13,07:31:11 | INFO | Loaded mixed dataset with 2755782 samples.
2024-05-13,07:31:11 | INFO | Loaded mixed dataset with 2755782 samples.
2024-05-13,07:31:12 | INFO | Loaded mixed dataset with 164657 samples.
2024-05-13,07:31:13 | INFO | Loaded mixed dataset with 164657 samples.
2024-05-13,07:31:13 | INFO | Loaded mixed dataset with 164657 samples.
2024-05-13,07:31:13 | INFO | Loaded mixed dataset with 164657 samples.
wandb: Currently logged in as: yasaman-parhizkar (vector-institute-aieng). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.17.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /fs01/home/yaspar/Documents/GitHub/Multimodal/MedMultiModal/src/wandb/run-20240513_073115-HPtuning_warmup_5000
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run HPtuning_warmup_5000
wandb: ⭐️ View project at https://wandb.ai/vector-institute-aieng/open-multi-modal
wandb: 🚀 View run at https://wandb.ai/vector-institute-aieng/open-multi-modal/runs/HPtuning_warmup_5000
wandb: WARNING Saving files without folders. If you want to preserve subdirectories pass base_path to wandb.save, i.e. wandb.save("/mnt/folder/file.h5", base_path="/mnt")
2024-05-13,07:31:39 | INFO | Eval Epoch: 0 [1024 / 164657]	Clip Loss: 6.555893	
2024-05-13,07:34:52 | INFO | Eval Epoch: 0 [103424 / 164657]	Clip Loss: 6.028051	
2024-05-13,07:36:51 | INFO | Eval Epoch: 0 clip_val_loss: 6.0024	epoch: 0.0000	num_samples: 164657.0000
2024-05-13,07:36:52 | INFO | Start epoch 0
2024-05-13,07:37:16 | INFO | Reducer buckets have been rebuilt in this iteration.
2024-05-13,07:37:16 | INFO | Reducer buckets have been rebuilt in this iteration.
2024-05-13,07:37:16 | INFO | Reducer buckets have been rebuilt in this iteration.
2024-05-13,07:37:16 | INFO | Reducer buckets have been rebuilt in this iteration.
2024-05-13,07:37:19 | INFO | Train Epoch: 0 [  16384/2755782 (1%)] Data (t): 21.546 Batch (t): 27.352, 599.013/s, 149.753/s/gpu LR: 0.000000 Logit Scale: 100.000 Contrastive_loss: 9.9181 (9.9181) Loss: 9.9181 (9.9181)
2024-05-13,07:41:44 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_37937.jpg
2024-05-13,07:41:46 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_53013.jpg
2024-05-13,07:42:22 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_26439.jpg
2024-05-13,07:42:38 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_07738.jpg
/fs01/home/yaspar/Documents/envs/mmm/lib/python3.7/site-packages/PIL/Image.py:993: UserWarning: Palette images with Transparency expressed in bytes should be converted to RGBA images
  "Palette images with Transparency expressed in bytes should be "
2024-05-13,07:46:31 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_07927.jpg
2024-05-13,07:46:40 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_50469.jpg
2024-05-13,07:49:58 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_50644.jpg
2024-05-13,07:50:14 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_63050.jpg
2024-05-13,07:51:00 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_67140.jpg
2024-05-13,07:54:11 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_61045.jpg
2024-05-13,07:56:35 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_47259.jpg
2024-05-13,07:58:40 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_64107.jpg
2024-05-13,08:00:47 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_78946.jpg
2024-05-13,08:01:19 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_24849.jpg
2024-05-13,08:06:21 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_63365.jpg
2024-05-13,08:09:40 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_35395.jpg
2024-05-13,08:10:10 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_77673.jpg
2024-05-13,08:10:14 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_60391.jpg
2024-05-13,08:10:49 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_25337.jpg
2024-05-13,08:12:07 | INFO | Train Epoch: 0 [1654784/2755782 (60%)] Data (t): 13.846 Batch (t): 20.877, 820.842/s, 205.210/s/gpu LR: 0.000001 Logit Scale: 99.999 Contrastive_loss: 8.1026 (9.0104) Loss: 8.1026 (9.0104)
2024-05-13,08:18:50 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_57545.jpg
2024-05-13,08:19:13 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_26232.jpg
2024-05-13,08:20:11 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_40763.jpg
2024-05-13,08:22:28 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_70505.jpg
2024-05-13,08:25:32 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_36338.jpg
2024-05-13,08:27:04 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_24535.jpg
2024-05-13,08:28:24 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_22299.jpg
2024-05-13,08:32:36 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_07233.jpg
2024-05-13,08:32:53 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_29364.jpg
2024-05-13,08:35:25 | INFO | Train Epoch: 0 [2752512/2755782 (100%)] Data (t): 9.062 Batch (t): 20.864, 875.838/s, 218.960/s/gpu LR: 0.000002 Logit Scale: 99.999 Contrastive_loss: 7.7486 (8.5898) Loss: 7.7486 (8.5898)
2024-05-13,08:35:46 | INFO | Eval Epoch: 1 [1024 / 164657]	Clip Loss: 5.479893	
2024-05-13,08:35:56 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_29364.jpg
2024-05-13,08:36:19 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_40763.jpg
2024-05-13,08:38:55 | INFO | Eval Epoch: 1 [103424 / 164657]	Clip Loss: 5.004804	
2024-05-13,08:40:53 | INFO | Eval Epoch: 1 clip_val_loss: 4.9655	epoch: 1.0000	num_samples: 164657.0000
2024-05-13,08:40:59 | INFO | Start epoch 1
2024-05-13,08:41:25 | INFO | Train Epoch: 1 [  16384/2755782 (1%)] Data (t): 22.035 Batch (t): 26.117, 627.328/s, 156.832/s/gpu LR: 0.000002 Logit Scale: 99.999 Contrastive_loss: 7.7271 (7.7271) Loss: 7.7271 (7.7271)
2024-05-13,08:41:31 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_57545.jpg
/fs01/home/yaspar/Documents/envs/mmm/lib/python3.7/site-packages/PIL/Image.py:993: UserWarning: Palette images with Transparency expressed in bytes should be converted to RGBA images
  "Palette images with Transparency expressed in bytes should be "
2024-05-13,08:48:44 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_50644.jpg
2024-05-13,08:51:14 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_07233.jpg
2024-05-13,08:53:17 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_26439.jpg
2024-05-13,08:58:42 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_63365.jpg
2024-05-13,09:01:20 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_24849.jpg
2024-05-13,09:02:15 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_61045.jpg
2024-05-13,09:05:48 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_35395.jpg
2024-05-13,09:10:35 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_63050.jpg
2024-05-13,09:14:04 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_60391.jpg
2024-05-13,09:14:22 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_50469.jpg
2024-05-13,09:14:42 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_07738.jpg
2024-05-13,09:15:12 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_22299.jpg
2024-05-13,09:16:10 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_70505.jpg
2024-05-13,09:16:23 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_36338.jpg
2024-05-13,09:16:25 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_37937.jpg
2024-05-13,09:16:39 | INFO | Train Epoch: 1 [1654784/2755782 (60%)] Data (t): 14.585 Batch (t): 21.137, 777.558/s, 194.389/s/gpu LR: 0.000003 Logit Scale: 99.999 Contrastive_loss: 7.3071 (7.5171) Loss: 7.3071 (7.5171)
2024-05-13,09:23:32 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_07927.jpg
2024-05-13,09:26:20 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_24535.jpg
2024-05-13,09:29:02 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_47259.jpg
2024-05-13,09:30:04 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_53013.jpg
2024-05-13,09:30:13 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_78946.jpg
2024-05-13,09:30:30 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_67140.jpg
2024-05-13,09:31:49 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_25337.jpg
2024-05-13,09:34:10 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_64107.jpg
2024-05-13,09:34:38 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_26232.jpg
2024-05-13,09:36:36 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_77673.jpg
2024-05-13,09:40:18 | INFO | Train Epoch: 1 [2752512/2755782 (100%)] Data (t): 7.796 Batch (t): 21.188, 834.917/s, 208.729/s/gpu LR: 0.000003 Logit Scale: 99.999 Contrastive_loss: 7.0868 (7.3737) Loss: 7.0868 (7.3737)
2024-05-13,09:40:36 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_57545.jpg
2024-05-13,09:40:42 | INFO | Eval Epoch: 2 [1024 / 164657]	Clip Loss: 5.048882	
2024-05-13,09:43:49 | INFO | Eval Epoch: 2 [103424 / 164657]	Clip Loss: 4.526430	
2024-05-13,09:45:46 | INFO | Eval Epoch: 2 clip_val_loss: 4.4891	epoch: 2.0000	num_samples: 164657.0000
2024-05-13,09:45:52 | INFO | Start epoch 2
2024-05-13,09:46:18 | INFO | Train Epoch: 2 [  16384/2755782 (1%)] Data (t): 22.514 Batch (t): 26.901, 609.045/s, 152.261/s/gpu LR: 0.000003 Logit Scale: 99.999 Contrastive_loss: 7.0607 (7.0607) Loss: 7.0607 (7.0607)
2024-05-13,09:51:57 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_47259.jpg
2024-05-13,09:56:34 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_40763.jpg
2024-05-13,09:57:05 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_77673.jpg
2024-05-13,09:59:08 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_07927.jpg
2024-05-13,09:59:11 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_24849.jpg
2024-05-13,10:00:10 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_63365.jpg
2024-05-13,10:01:04 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_64107.jpg
2024-05-13,10:02:44 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_22299.jpg
2024-05-13,10:03:41 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_67140.jpg
2024-05-13,10:08:06 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_26232.jpg
2024-05-13,10:10:36 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_61045.jpg
2024-05-13,10:19:43 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_26439.jpg
2024-05-13,10:21:37 | INFO | Train Epoch: 2 [1654784/2755782 (60%)] Data (t): 14.341 Batch (t): 21.182, 767.293/s, 191.823/s/gpu LR: 0.000004 Logit Scale: 100.000 Contrastive_loss: 6.7875 (6.9241) Loss: 6.7875 (6.9241)
2024-05-13,10:21:42 | ERROR | Error loading image /projects/aieng/multimodal/datasets/roco/cache/images/ROCO_07738.jpg
srun: Job step aborted: Waiting up to 62 seconds for job step to finish.
slurmstepd: error: *** JOB 12581130 ON gpu191 CANCELLED AT 2024-05-13T10:24:11 ***
slurmstepd: error: *** STEP 12581130.0 ON gpu191 CANCELLED AT 2024-05-13T10:24:11 ***
